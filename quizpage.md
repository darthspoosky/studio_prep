# PrepTalk: The Ultimate Quiz System - Design Document

## 1. Vision

To evolve the Daily Quiz page into a comprehensive, multi-modal quiz system. It will be the central hub for practice, performance analysis, and personalized improvement, catering to diverse study needs from past-paper practice to user-generated content analysis.

## 2. Core Feature Pillars: The Three Quiz Modes

The new quiz page will be built around a tabbed interface offering three distinct modes of practice.

### Pillar 1: Past Year Question Bank

- **Objective**: Allow users to practice with official past UPSC question papers.
- **Features**:
    - **Browse by Year**: A grid or list view allowing users to select a specific year (e.g., "UPSC CSE 2023"). Each entry will show progress and number of questions.
    - **Browse by Syllabus Section**: A collapsible accordion interface for users to drill down into specific GS paper sections (e.g., GS-I > Modern History > Freedom Struggle) and practice questions from that topic.

### Pillar 2: PDF/Image to Quiz Converter

- **Objective**: Empower users to turn their own study materials into interactive quizzes.
- **Features**:
    - **File Upload**: A drag-and-drop or file selection interface for uploading PDFs and images (JPEG, PNG).
    - **AI-Powered Conversion**: A Genkit flow will process the uploaded document using OCR and NLP to identify questions, options, and correct answers.
    - **Quiz Generation**: The system will create a new, playable quiz from the extracted content.
    - **Configuration**: Users can set a time limit and choose whether the AI should attempt to generate explanations for answers.

### Pillar 3: Curated Question Bank

- **Objective**: Provide a dynamic, searchable, and filterable library of all available questions.
- **Features**:
    - **Advanced Filtering**: Users can filter questions by subject (GS-I, CSAT, etc.), difficulty (Easy, Medium, Hard), and question type.
    - **Full-Text Search**: A search bar to find questions containing specific keywords.
    - **Question Sets**: Display questions grouped into logical sets (e.g., "Current Affairs: July 2024," "Polity: Fundamental Rights") with metadata like question count, estimated time, and number of attempts by other users.

## 3. Performance Analytics Tab

A dedicated tab within the quiz system for deep performance analysis.

- **Key Metrics**: Display high-level stats like Total Questions Attempted, Overall Accuracy, Average Time Per Question, and Current Day Streak.
- **Performance Trends**: An interactive line chart showing accuracy and other metrics over selectable timeframes (Week, Month, Year).
- **Subject-wise Breakdown**: A bar chart visualizing accuracy for each subject (History, Polity, etc.) to quickly identify strengths and weaknesses.
- **Question Type Analysis**: A radar chart showing performance across different question formats (e.g., Factual, Analytical, Statement-based).
- **AI-Powered Insights**: A list of actionable suggestions generated by an AI agent that analyzes the user's performance data. It will recommend specific topics to focus on, suggest relevant practice sets, and highlight areas of improvement.

## 4. Dashboard Integration

Key insights from the quiz system will be surfaced on the main user dashboard via two new widgets:
- **Quiz Performance Widget**: A compact card showing a weekly performance graph, average score, and total questions attempted.
- **Weak Area Focus Widget**: An AI-driven card that highlights the top 3 subjects where the user has the lowest accuracy, suggesting specific topics to revise.

## 5. Full-Stack Technical Blueprint

### 5.1. Backend & AI

- **New Genkit Flows**:
    - `pdfToQuizFlow`: An AI flow that takes a file (as a data URI), performs OCR/parsing, identifies question-answer blocks, and outputs a structured JSON of quiz questions.
    - `performanceAnalysisFlow`: An AI flow that takes a user's quiz history as input and generates personalized textual insights and recommendations.
- **New Backend Services**:
    - `quizService.ts`: To manage fetching questions from various sources (past papers database, custom bank).
    - `analyticsService.ts`: To calculate and aggregate user performance statistics from `quizAttempts`.
- **Database Schema Expansion**:
    - `quizSessions` (Collection): To store metadata for each quiz attempt (e.g., `sessionId`, `userId`, `type`, `score`, `duration`).
    - `pastYearQuestions` (Collection): A pre-populated collection with past UPSC questions, tagged by year, subject, and topic.

### 5.2. Frontend

- **New Page**: `/daily-quiz/analysis` for the dedicated analytics tab.
- **Component Refactoring**: The main `/daily-quiz` page will be rebuilt to house the new three-tab system.
- **New Components**:
    - `PastYearQuizMode`, `PDFToQuizConverter`, `CuratedQuestionBank` components for each mode.
    - `QuizAnalysisTab` for the analytics view.
    - `QuizPerformanceWidget`, `WeakAreaFocusWidget` for the main dashboard.
    - Various charting components using `recharts`.
